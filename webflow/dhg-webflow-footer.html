<!-- DHG Card Scripts - Paste in Site Settings > Custom Code > Footer -->
<script>
(function() {
    'use strict';

    document.addEventListener('DOMContentLoaded', initDHGCards);

    function initDHGCards() {
        var cards = document.querySelectorAll('.dhg-card');
        cards.forEach(function(card) { initCard(card); });
    }

    function initCard(card) {
        // Flip buttons
        var flipBtns = card.querySelectorAll('.dhg-flip-btn');
        flipBtns.forEach(function(btn) {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                card.classList.toggle('flipped');
            });
        });

        // Front panels (HYPE, DEAL) - accordion
        var frontPanels = card.querySelectorAll('.dhg-front-panels .dhg-panel');
        frontPanels.forEach(function(panel) {
            var header = panel.querySelector('.dhg-panel-header');
            if (header) {
                header.addEventListener('click', function() {
                    frontPanels.forEach(function(p) {
                        if (p !== panel) p.classList.remove('expanded');
                    });
                    panel.classList.toggle('expanded');
                });
            }
        });

        // Back panels (facts) - accordion
        var factsPanels = card.querySelectorAll('.dhg-facts-panel');
        factsPanels.forEach(function(panel) {
            var header = panel.querySelector('.dhg-facts-panel-header');
            if (header) {
                header.addEventListener('click', function() {
                    factsPanels.forEach(function(p) {
                        if (p !== panel) p.classList.remove('expanded');
                    });
                    panel.classList.toggle('expanded');
                });
            }
        });

        // Heart button toggle
        var heartBtns = card.querySelectorAll('.dhg-heart-btn');
        heartBtns.forEach(function(btn) {
            btn.addEventListener('click', function(e) {
                e.stopPropagation();
                heartBtns.forEach(function(hb) {
                    hb.classList.toggle('dhg-heart-active');
                });
            });
        });

        // Monitor badge icons
        var badge = card.querySelector('.dhg-monitor-badge');
        if (badge) {
            var badgeText = badge.getAttribute('data-badge');
            var badgeIcons = {
                'Viral': 'üî•', 'Trending': 'üìà', 'New': '‚ú®', 'Hot': 'üî•',
                'Recalled': '‚ö†Ô∏è', 'Discontinued': 'üö´', 'Award Winner': 'üèÜ',
                'Editor Pick': '‚≠ê', 'Flagged': 'üö©', 'Grain of Salt': 'üßÇ'
            };
            var iconEl = badge.querySelector('.dhg-badge-icon');
            if (iconEl && badgeIcons[badgeText]) {
                iconEl.textContent = badgeIcons[badgeText];
            }
            if (!badgeText || badgeText === '') {
                badge.style.display = 'none';
            }
        }

        // Start expanded
        frontPanels.forEach(function(p) { p.classList.add('expanded'); });
        factsPanels.forEach(function(p) { p.classList.add('expanded'); });
    }

    window.DHGCards = { init: initDHGCards, initCard: initCard };
})();
</script>
